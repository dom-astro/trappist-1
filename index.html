<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualisation des Orbites d'Exoplan√®tes</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>üåå Visualisation des Orbites d'Exoplan√®tes</h1>
        
        <div class="controls">
            <button id="playPause">‚è∏Ô∏è Pause</button>
            <button id="reset">üîÑ Reset</button>
            <div class="speed-control">
                <label>Vitesse:</label>
                <input type="range" id="speedSlider" min="0.1" max="5" step="0.1" value="1">
                <span id="speedValue">1x</span>
            </div>
            <div class="trail-controls">
                <label>
                    <input type="checkbox" id="showTrails" checked>
                    Tra√Æn√©es
                </label>
                <label>
                    <input type="checkbox" id="fadeTrails" checked>
                    Estompage
                </label>
            </div>
            <div class="star-controls">
                <label>
                    <input type="checkbox" id="starTwinkle" checked>
                    Scintillement √©toile
                </label>
                <div class="twinkle-speed-control">
                    <label>Vitesse scintillement:</label>
                    <input type="range" id="twinkleSpeedSlider" min="2" max="15" step="1" value="8">
                    <span id="twinkleSpeedValue">8s</span>
                </div>
            </div>
            <div class="habitable-zone-controls">
                <label>
                    <input type="checkbox" id="showHabitableZone" checked>
                    Zone d'habitabilit√©
                </label>
            </div>
            <div class="system-select">
                <label for="systemSelector">Syst√®me :</label>
                <select id="systemSelector">
                    <option value="trappist-1">TRAPPIST-1</option>
                    <option value="solaire">Solaire</option>
                </select>
            </div>
        </div>
        
        <div class="visualization-container">
            <div id="exoplanet-viz" style="position: relative;"></div>
            <div class="legend" id="legend"></div>
        </div>
        
        <div class="info-panel" id="info-panel">
            <h3>Informations</h3>
            <p>Survolez l'√©toile ou une plan√®te avec la souris pour voir leurs d√©tails. Les orbites sont repr√©sent√©es √† l'√©chelle relative.</p>
        </div>
    </div>

    <script src="js/exoplanets.js"></script>
    <script src="data/trappist-1.js"></script>
    <script src="data/solaire.js"></script>
    <script>
        // Stocker les donn√©es des deux syst√®mes
        const systems = {
            "trappist-1": typeof exoplanetData !== "undefined" ? exoplanetData : [],
            "solaire": typeof solaireData !== "undefined" ? solaireData : []
        };

        // Initialiser la visualisation avec TRAPPIST-1 par d√©faut
        let orbits = new Exoplanets('exoplanet-viz', systems["trappist-1"], {
            width: 800,
            height: 600,
            animationSpeed: 1,
            showTrails: true,
            showOrbits: true,
            timeScale: 1
        });

        // Fonction pour changer de syst√®me
        function switchSystem(systemKey) {
            // Nettoyer l'ancien SVG ou canvas
            document.getElementById('exoplanet-viz').innerHTML = '';
            // D√©finir le timeScale selon le syst√®me
            let timeScale = 1;
            if (systemKey === 'solaire') {
                timeScale = 365.25 / 60; // 1 an en 1 minute
            }
            // Recr√©er la visualisation avec les nouvelles donn√©es
            orbits = new Exoplanets('exoplanet-viz', systems[systemKey], {
                width: 800,
                height: 600,
                animationSpeed: parseFloat(document.getElementById('speedSlider').value),
                showTrails: document.getElementById('showTrails').checked,
                showOrbits: true,
                timeScale: timeScale
            });
            // Mettre √† jour le panneau d'information
            updateInfoPanel(systemKey);
        }

        // Fonction pour mettre √† jour le panneau d'information
        function updateInfoPanel(systemKey) {
            const data = systems[systemKey];
            let html = `<h3>Informations</h3>`;
            if (data && data.star && data.planets) {
                html += `<p><strong>Syst√®me :</strong> ${data.star.name || (systemKey === 'trappist-1' ? 'TRAPPIST-1' : 'Solaire')}</p>`;
                html += `<p><strong>√âtoile :</strong> ${data.star.name || 'Inconnue'}<br>`;
                html += `<strong>Type spectral :</strong> ${data.star.spectralType || 'Inconnu'}<br>`;
                html += `<strong>Temp√©rature :</strong> ${data.star.temperature ? data.star.temperature + ' K' : 'Inconnue'}<br>`;
                html += `<strong>Rayon :</strong> ${data.star.radius ? data.star.radius + ' R‚òâ' : 'Inconnu'}<br>`;
                html += `<strong>Masse :</strong> ${data.star.mass ? data.star.mass + ' M‚òâ' : 'Inconnue'}</p>`;
                html += `<p><strong>Nombre de plan√®tes :</strong> ${data.planets.length}</p>`;
                html += `<p>Survolez l'√©toile ou une plan√®te avec la souris pour voir leurs d√©tails. Les orbites sont repr√©sent√©es √† l'√©chelle relative.</p>`;
            } else {
                html += `<p>Donn√©es indisponibles pour ce syst√®me.</p>`;
            }
            document.getElementById('info-panel').innerHTML = html;
        }

        // Appel initial pour afficher les infos du syst√®me par d√©faut
        updateInfoPanel('trappist-1');

        // Gestionnaire de changement de syst√®me
        document.getElementById('systemSelector').addEventListener('change', function() {
            switchSystem(this.value);
        });

        // Contr√¥les
        document.getElementById('playPause').addEventListener('click', function() {
            if (orbits.isPlaying) {
                orbits.pause();
                this.textContent = '‚ñ∂Ô∏è Play';
            } else {
                orbits.play();
                this.textContent = '‚è∏Ô∏è Pause';
            }
        });

        document.getElementById('reset').addEventListener('click', function() {
            orbits.reset();
        });

        document.getElementById('speedSlider').addEventListener('input', function() {
            const speed = parseFloat(this.value);
            orbits.setSpeed(speed);
            document.getElementById('speedValue').textContent = speed + 'x';
        });

        // Contr√¥les des tra√Æn√©es
        document.getElementById('showTrails').addEventListener('change', function() {
            orbits.setTrails(this.checked);
        });

        document.getElementById('fadeTrails').addEventListener('change', function() {
            orbits.setFadeTrails(this.checked);
        });

        // Contr√¥les de l'√©toile
        document.getElementById('starTwinkle').addEventListener('change', function() {
            orbits.setStarTwinkle(this.checked);
        });

        document.getElementById('twinkleSpeedSlider').addEventListener('input', function() {
            const speed = parseInt(this.value);
            orbits.setTwinkleSpeed(speed);
            document.getElementById('twinkleSpeedValue').textContent = speed + 's';
        });

        // Contr√¥le de la zone d'habitabilit√©
        document.getElementById('showHabitableZone').addEventListener('change', function() {
            orbits.setHabitableZone(this.checked);
        });
    </script>
</body>
</html>